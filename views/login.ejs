<!doctype html>
<html>
  <head>
    <title>Login/Register</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="/css/common.css" />
  </head>
  <body>
    <%- include header.ejs %>
		<div class="container">
			<div class="main-card">
				<div class="proceed_options">
					<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#signup" aria-expanded="false" aria-controls="signup">
						Sign Up
					</button>
					<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#login" aria-expanded="true" aria-controls="login">
						Login
					</button>
				</div>
				<form class="signup collapse" id="signup">
					<div class="form-group row">
						<label for="signUpFirstName" class="col-sm-2 col-form-label">First Name</label>
						<div class="col-sm-10">
							<input type="firstName" class="form-control" id="signUpFirstName" placeholder="First Name" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpLastName" class="col-sm-2 col-form-label">Last Name</label>
						<div class="col-sm-10">
							<input type="lastName" class="form-control" id="signUpLastName" placeholder="Last Name" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpEmailsignUpEmail" class="col-sm-2 col-form-label">Email</label>
						<div class="col-sm-10">
							<input type="email" class="form-control" id="signUpEmail" placeholder="Email" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpUsername" class="col-sm-2 col-form-label">Username</label>
						<div class="col-sm-10">
							<input type="username" class="form-control" id="signUpUsername" placeholder="Username" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpPassword" class="col-sm-2 col-form-label">Password</label>
						<div class="col-sm-10">
							<input type="password" class="form-control" id="signUpPassword" placeholder="Password" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpConfirmPassword" class="col-sm-2 col-form-label">Confirm Password</label>
						<div class="col-sm-10">
							<input type="confirmPassword" class="form-control" id="signUpConfirmPassword" placeholder="Confirm Password" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpSchool" class="col-sm-2 col-form-label">School</label>
						<div class="col-sm-10">
							<input type="school" class="form-control" id="signUpSchool" placeholder="School" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpBio" class="col-sm-2 col-form-label">Bio</label>
						<div class="col-sm-10">
							<textarea class="span6" rows="3" placeholder="Bio" id="signUpBio" required></textarea>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpGrade" class="col-sm-2 col-form-label">Grade</label>
						<div class="col-sm-10">
							<select class="custom-select" id="signUpGrade">
								<option value='Not Specified' selected>Not Specified</option>
								<option value='Kindergarten'>Kindergarten</option>
								<option value='1st'>1st</option>
								<option value='2nd'>2nd</option>
								<option value='3rd'>3rd</option>
								<option value='4th'>4th</option>
								<option value='5th'>5th</option>
								<option value='6th'>6th</option>
								<option value='7th'>7th</option>
								<option value='8th'>8th</option>
								<option value='9th'>9th</option>
								<option value='10th'>10th</option>
								<option value='11th'>11th</option>
								<option value='12th'>12th</option>
								<option value='College Prep'>College Prep</option>
								<option value='AP'>AP</option>
							</select>
						</div>
					</div>
					<div class="form-group row">
						<label for="signUpPic" class="col-sm-2 col-form-label">Profile Picture</label>
						<div class="col-sm-10">
							<label class="custom-file">
								<input type="file" id="signUpPic" class="custom-file-input">
								<span class="custom-file-control"></span>
							</label>
						</div>
					</div>
					<button class="btn btn-primary" type="button" id="signup-btn">
						Submit
					</button>
				</form>
				<form class="login collapse" id="login">
					<div class="form-group row">
						<label for="loginUsername" class="col-sm-2 col-form-label">Username or Email</label>
						<div class="col-sm-10">
							<input type="username" class="form-control" id="loginUsername" placeholder="Username" required>
						</div>
					</div>
					<div class="form-group row">
						<label for="loginPassword" class="col-sm-2 col-form-label">Password</label>
						<div class="col-sm-10">
							<input type="password" class="form-control" id="loginPassword" placeholder="Password" required>
						</div>
					</div>
					<button class="btn btn-primary" type="button" id="login-btn">
						Submit
					</button>
				</form>
			</div>
		</div>

		<script>
			// Input checking functions
			function checkBadLanguage(str) {
				return false;
			}

			function checkJavascript(str) {
				return false;
			}

			// Send data to server functions
			function sendLoginRequest() {
				if(!checkJavascript($("#loginUsername").val())) {
					console.log("Login username does not consist of javascript");
				}

				if(!checkJavascript($("#loginPassword").val())) {
					console.log("Login password does not consist of javascript");
				}

				$.ajax({
					type: 'post',
					url: '/login',
					data: { 'action': 'login', 'username': $("#loginUsername").val(), 'password': $("#loginPassword").val() },
					dataType: "json",
					success: function (data) {
						console.log(data.status);
					},
					error: function (xhr, status, err) {
						console.error('text status '+status+', err '+err);
					}
				});
			}
			
			function sendSignUpRequest() {				
				// Make sure that the passwords are the same
				if($("#signUpPassword").val() != $("#signUpConfirmPassword").val()) {
					console.log("Passwords don't match")
				}

				if(!checkJavascript($("#signUpUsername").val())) {
					console.log("Sign up username does not consist of javascript");
				}

				if(!checkJavascript($("#signUpPassword").val())) {
					console.log("Sign up password does not consist of javascript");
				}

				var signUpRequestData = {
					'action': 'signup',
					'first_name': $("#signUpFirstName").val(),
					'last_name': $("#signUpLastName").val(),
					'email': $("#signUpEmail").val(),
					'username': $("#signUpUsername").val(),
					'password': $("#signUpPassword").val(),
					'school': $("#signUpSchool").val(),
					'bio': $("#signUpBio").val(),
					'picture': $("#signUpPic").val(),
					'grade': $("#signUpGrade").val()
					};

				$.ajax({
					type: 'post',
					url: '/login',
					data: signUpRequestData,
					dataType: "json",
					success: function (data) {
						console.log(data.status);
					},
					error: function (xhr, status, err) {
						console.error('text status '+status+', err '+err);
					}
				});
			}

			// Handle on click event functions
			$('#login-btn').on('click', function() {
				sendLoginRequest();
			});
			
			$('#signup-btn').on('click', function() {
				sendSignUpRequest();
			});
		</script>
  </body>
</html>
