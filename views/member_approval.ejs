<!doctype html>
<html>
  <head>
    <title>Membership Approval</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="/css/common.css" />
  </head>
  <body>
    <%- include header.ejs %>
		<div class="content">
			<% for(var i=0; i<data.length; i++) { %>
				<div class="w3-card-4">
					<!-- Need to add logic to replace the default image if actual image exists. <%= data[i].picture %> -->
					<img src="default_profile_img.png" alt="Profile">
					<div class="w3-container w3-left">
						<h3><%= data[i].first_name %> <%= data[i].last_name %></h3>
						<p><%= data[i].school %></p>
						<div class="decision-buttons">
							<button type="button" class="btn btn-success approve" data-id="<%= data[i].id %>">Accept</button>
							<button type="button" class="btn btn-danger decline" data-id="<%= data[i].id %>">Decline</button>
						</div>
					</div>
				</div>
			<% } %>
		</div>

		<script>
			// Send data to server functions
			function sendUserRequestAccept(id) {
				$.ajax({
					type: 'post',
					url: '/member_approval',
					data: { 'action': 'approve', 'id': id },
					dataType: "json",
					success: function (data) {
						console.log(data.status);
					},
					error: function (xhr, status, err) {
						console.error('text status '+status+', err '+err);
					}
				});
			}

			function sendUserRequestDecline(id) {
				$.ajax({
					type: 'post',
					url: '/member_approval',
					data: { 'action': 'decline', 'id': id },
					dataType: "json",
					success: function (data) {
						console.log(data.status);
					},
					error: function (xhr, status, err) {
						console.error('text status '+status+', err '+err);
					}
				});
			}

			// Handle on click events for buttons
			$('.btn.approve').on('click', function() {
				console.log("Approve button clicked");
				console.log($(this).data("id"));
				sendUserRequestAccept($(this).data("id"));
			});

			$('.btn.decline').on('click', function() {
				console.log("Decline button clicked");
				console.log($(this).data("id"));
				sendUserRequestDecline($(this).data("id"));
			});
		</script>
  </body>
</html>
